<app-job-tab [tab]="currentPage" (onTabChange)="currentPage = $event"></app-job-tab>

@if (currentPage === 'input') {
<app-effect-prediction [formValue]="jobInfo" [showJobTab]="false"></app-effect-prediction>

} @else {
<!-- Model Results -->
<div class="flex flex-col h-full gap-8">
  <div class="flex items-center justify-between">
    @let status = statusResponse$ | async;
    @if (status) {
    <div>
      <h5 class="flex items-center gap-2 mb-2 font-bold opacity-100 leading-xl">
        Job ID: {{ status.job_id || "loading" }}
        <button type="button" title="copy job id" class="border-none cursor-pointer">
          <i class="pi pi-copy" (click)="copyAndPasteURL()"></i>
        </button>
      </h5>
      <h6 class="text-text-secondary leading-lg">
        Submission Time:
        {{ (status.time_created || 0) * 1000 | date : "short" }}
      </h6>
    </div>
    }
    <div class="flex items-center gap-2">

      <!-- TODO: add button here -->

    </div>
  </div>

  @if (!showResults) {
  <app-loading [statusQuery$]="statusResponse$" (progressChange)="onProgressChange($event)" [estimatedTime]="1 * 60">
  </app-loading>
  }

  <div class="flex flex-col gap-8" [class.hidden]="!showResults">
    <p-panel>
      <ng-template pTemplate="header">
        <h6 class="grow">Results</h6>
      </ng-template>
      <ng-template pTemplate="content">
        <div class="flex flex-col gap-6 p-6">
          <!-- Enzyme Sequence -->
          <div class="flex flex-col gap-4">
              <p class="font-semibold underline decoration-dotted">Enzyme Sequence</p>
              <!-- debug - selected positions: {{ selectedPositions | json }} -->
              <div class="p-2 pt-5 bg-[#F8F9FA] rounded-md">
                <app-sequence-position-selector
                  [sequence]="sequence"
                  [mutedPositions]="mutedPositions"
                  [selectedPositions]="selectedPositions"
                  (selectedPositionsChange)="onSelectedPositionsChange($event)"
                ></app-sequence-position-selector>
              </div>
            </div>

          <!-- Mutation Effect and Structure -->
          <div class="flex gap-4">
              <div class="flex flex-col gap-4 w-1/2">
                <div class="flex items-center justify-between">
                  <p class="font-semibold underline decoration-dotted">Mutation Effect Heatmap</p>
                  <!-- Color key -->
                  <svg width="218" height="11" viewBox="0 0 218 11" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3.90527 9H1.54874V1.36364H4.00968C4.75044 1.36364 5.38432 1.51651 5.91131 1.82227C6.4383 2.12553 6.84224 2.56179 7.12314 3.13104C7.40403 3.6978 7.54448 4.37642 7.54448 5.1669C7.54448 5.96236 7.40279 6.64719 7.11941 7.22141C6.83603 7.79315 6.42338 8.23313 5.88148 8.54137C5.33958 8.84712 4.68084 9 3.90527 9ZM2.47346 8.17969H3.84561C4.47701 8.17969 5.00027 8.05788 5.41539 7.81428C5.83052 7.57067 6.14 7.2239 6.34384 6.77397C6.54767 6.32404 6.64959 5.78835 6.64959 5.1669C6.64959 4.55043 6.54892 4.01971 6.34757 3.57475C6.14622 3.12731 5.84544 2.78427 5.44522 2.54563C5.04501 2.30451 4.54661 2.18395 3.95002 2.18395H2.47346V8.17969ZM11.3776 9.11932C10.8257 9.11932 10.3497 8.99751 9.94949 8.75391C9.55176 8.50781 9.24476 8.16477 9.0285 7.72479C8.81472 7.28232 8.70783 6.76776 8.70783 6.18111C8.70783 5.59446 8.81472 5.07741 9.0285 4.62997C9.24476 4.18004 9.54554 3.82955 9.93084 3.57848C10.3186 3.32493 10.771 3.19815 11.2881 3.19815C11.5864 3.19815 11.8809 3.24787 12.1718 3.3473C12.4626 3.44673 12.7274 3.60831 12.966 3.83203C13.2046 4.05327 13.3948 4.34659 13.5365 4.712C13.6782 5.07741 13.749 5.52734 13.749 6.06179V6.43466H9.33425V5.67401H12.8541C12.8541 5.35085 12.7895 5.0625 12.6602 4.80895C12.5335 4.5554 12.352 4.35529 12.1159 4.20863C11.8822 4.06197 11.6063 3.98864 11.2881 3.98864C10.9376 3.98864 10.6343 4.07564 10.3783 4.24964C10.1247 4.42116 9.9296 4.64489 9.79288 4.92081C9.65616 5.19673 9.5878 5.49254 9.5878 5.80824V6.31534C9.5878 6.74787 9.66238 7.11452 9.81152 7.41531C9.96316 7.7136 10.1732 7.94105 10.4417 8.09766C10.7101 8.25178 11.0221 8.32884 11.3776 8.32884C11.6088 8.32884 11.8176 8.29652 12.004 8.23189C12.1929 8.16477 12.3557 8.06534 12.4925 7.93359C12.6292 7.79936 12.7348 7.63281 12.8094 7.43395L13.6595 7.67259C13.57 7.96094 13.4197 8.21449 13.2084 8.43324C12.9971 8.6495 12.7361 8.81854 12.4253 8.94034C12.1146 9.05966 11.7654 9.11932 11.3776 9.11932ZM15.9676 1.36364V9H15.0876V1.36364H15.9676ZM19.9806 9.11932C19.4288 9.11932 18.9527 8.99751 18.5525 8.75391C18.1548 8.50781 17.8478 8.16477 17.6315 7.72479C17.4177 7.28232 17.3109 6.76776 17.3109 6.18111C17.3109 5.59446 17.4177 5.07741 17.6315 4.62997C17.8478 4.18004 18.1486 3.82955 18.5339 3.57848C18.9217 3.32493 19.3741 3.19815 19.8911 3.19815C20.1894 3.19815 20.484 3.24787 20.7748 3.3473C21.0657 3.44673 21.3304 3.60831 21.569 3.83203C21.8077 4.05327 21.9978 4.34659 22.1395 4.712C22.2812 5.07741 22.3521 5.52734 22.3521 6.06179V6.43466H17.9373V5.67401H21.4572C21.4572 5.35085 21.3925 5.0625 21.2633 4.80895C21.1365 4.5554 20.955 4.35529 20.7189 4.20863C20.4852 4.06197 20.2093 3.98864 19.8911 3.98864C19.5406 3.98864 19.2373 4.07564 18.9813 4.24964C18.7278 4.42116 18.5326 4.64489 18.3959 4.92081C18.2592 5.19673 18.1908 5.49254 18.1908 5.80824V6.31534C18.1908 6.74787 18.2654 7.11452 18.4146 7.41531C18.5662 7.7136 18.7762 7.94105 19.0447 8.09766C19.3132 8.25178 19.6251 8.32884 19.9806 8.32884C20.2118 8.32884 20.4206 8.29652 20.607 8.23189C20.7959 8.16477 20.9588 8.06534 21.0955 7.93359C21.2322 7.79936 21.3378 7.63281 21.4124 7.43395L22.2626 7.67259C22.1731 7.96094 22.0227 8.21449 21.8114 8.43324C21.6001 8.6495 21.3391 8.81854 21.0284 8.94034C20.7176 9.05966 20.3684 9.11932 19.9806 9.11932ZM26.1814 3.27273V4.01847H23.2134V3.27273H26.1814ZM24.0784 1.90057H24.9584V7.35938C24.9584 7.60795 24.9945 7.79439 25.0665 7.91868C25.1411 8.04048 25.2356 8.12251 25.3499 8.16477C25.4668 8.20455 25.5898 8.22443 25.7191 8.22443C25.816 8.22443 25.8956 8.21946 25.9577 8.20952C26.0198 8.19709 26.0696 8.18714 26.1068 8.17969L26.2858 8.97017C26.2262 8.99254 26.1429 9.01491 26.036 9.03729C25.9291 9.06214 25.7936 9.07457 25.6296 9.07457C25.381 9.07457 25.1374 9.02113 24.8987 8.91424C24.6626 8.80735 24.4662 8.64453 24.3096 8.42578C24.1555 8.20703 24.0784 7.93111 24.0784 7.59801V1.90057ZM29.8449 9.11932C29.293 9.11932 28.817 8.99751 28.4168 8.75391C28.019 8.50781 27.712 8.16477 27.4958 7.72479C27.282 7.28232 27.1751 6.76776 27.1751 6.18111C27.1751 5.59446 27.282 5.07741 27.4958 4.62997C27.712 4.18004 28.0128 3.82955 28.3981 3.57848C28.7859 3.32493 29.2383 3.19815 29.7554 3.19815C30.0537 3.19815 30.3482 3.24787 30.6391 3.3473C30.9299 3.44673 31.1946 3.60831 31.4333 3.83203C31.6719 4.05327 31.8621 4.34659 32.0038 4.712C32.1455 5.07741 32.2163 5.52734 32.2163 6.06179V6.43466H27.8015V5.67401H31.3214C31.3214 5.35085 31.2568 5.0625 31.1275 4.80895C31.0008 4.5554 30.8193 4.35529 30.5831 4.20863C30.3495 4.06197 30.0736 3.98864 29.7554 3.98864C29.4049 3.98864 29.1016 4.07564 28.8456 4.24964C28.592 4.42116 28.3969 4.64489 28.2602 4.92081C28.1234 5.19673 28.0551 5.49254 28.0551 5.80824V6.31534C28.0551 6.74787 28.1297 7.11452 28.2788 7.41531C28.4304 7.7136 28.6405 7.94105 28.909 8.09766C29.1774 8.25178 29.4894 8.32884 29.8449 8.32884C30.076 8.32884 30.2848 8.29652 30.4713 8.23189C30.6602 8.16477 30.823 8.06534 30.9597 7.93359C31.0965 7.79936 31.2021 7.63281 31.2767 7.43395L32.1268 7.67259C32.0373 7.96094 31.8869 8.21449 31.6756 8.43324C31.4644 8.6495 31.2033 8.81854 30.8926 8.94034C30.5819 9.05966 30.2326 9.11932 29.8449 9.11932ZM33.5549 9V3.27273H34.4051V4.13778H34.4647C34.5691 3.8544 34.758 3.62447 35.0315 3.44798C35.3049 3.27148 35.6131 3.18324 35.9562 3.18324C36.0208 3.18324 36.1016 3.18448 36.1986 3.18697C36.2955 3.18945 36.3688 3.19318 36.4185 3.19815V4.09304C36.3887 4.08558 36.3204 4.0744 36.2135 4.05948C36.1091 4.04208 35.9984 4.03338 35.8816 4.03338C35.6032 4.03338 35.3546 4.0918 35.1359 4.20863C34.9196 4.32298 34.7481 4.48207 34.6213 4.6859C34.497 4.88725 34.4349 5.11719 34.4349 5.37571V9H33.5549ZM37.4616 9V3.27273H38.3416V9H37.4616ZM37.9091 2.31818C37.7376 2.31818 37.5897 2.25977 37.4654 2.14293C37.3436 2.0261 37.2827 1.88565 37.2827 1.72159C37.2827 1.55753 37.3436 1.41708 37.4654 1.30025C37.5897 1.18342 37.7376 1.125 37.9091 1.125C38.0806 1.125 38.2273 1.18342 38.3491 1.30025C38.4734 1.41708 38.5355 1.55753 38.5355 1.72159C38.5355 1.88565 38.4734 2.0261 38.3491 2.14293C38.2273 2.25977 38.0806 2.31818 37.9091 2.31818ZM42.2801 9.11932C41.763 9.11932 41.3093 8.99627 40.9191 8.75018C40.5313 8.50408 40.228 8.1598 40.0093 7.71733C39.793 7.27486 39.6849 6.75781 39.6849 6.16619C39.6849 5.5696 39.793 5.04883 40.0093 4.60387C40.228 4.15891 40.5313 3.81339 40.9191 3.56729C41.3093 3.3212 41.763 3.19815 42.2801 3.19815C42.7971 3.19815 43.2495 3.3212 43.6373 3.56729C44.0276 3.81339 44.3308 4.15891 44.5471 4.60387C44.7658 5.04883 44.8752 5.5696 44.8752 6.16619C44.8752 6.75781 44.7658 7.27486 44.5471 7.71733C44.3308 8.1598 44.0276 8.50408 43.6373 8.75018C43.2495 8.99627 42.7971 9.11932 42.2801 9.11932ZM42.2801 8.32884C42.6728 8.32884 42.996 8.22816 43.2495 8.02681C43.5031 7.82546 43.6907 7.56072 43.8125 7.2326C43.9343 6.90447 43.9953 6.54901 43.9953 6.16619C43.9953 5.78338 43.9343 5.42667 43.8125 5.09606C43.6907 4.76545 43.5031 4.49822 43.2495 4.29439C42.996 4.09055 42.6728 3.98864 42.2801 3.98864C41.8873 3.98864 41.5641 4.09055 41.3106 4.29439C41.057 4.49822 40.8694 4.76545 40.7476 5.09606C40.6258 5.42667 40.5649 5.78338 40.5649 6.16619C40.5649 6.54901 40.6258 6.90447 40.7476 7.2326C40.8694 7.56072 41.057 7.82546 41.3106 8.02681C41.5641 8.22816 41.8873 8.32884 42.2801 8.32884ZM49.8279 6.65838V3.27273H50.7078V9H49.8279V8.03054H49.7682C49.634 8.32138 49.4252 8.56871 49.1418 8.77255C48.8584 8.9739 48.5004 9.07457 48.0679 9.07457C47.71 9.07457 47.3918 8.99627 47.1134 8.83967C46.835 8.68058 46.6162 8.44194 46.4571 8.12376C46.298 7.80309 46.2185 7.39915 46.2185 6.91193V3.27273H47.0985V6.85227C47.0985 7.26989 47.2153 7.60298 47.449 7.85156C47.6851 8.10014 47.9859 8.22443 48.3513 8.22443C48.57 8.22443 48.7925 8.1685 49.0187 8.05664C49.2474 7.94478 49.4388 7.77326 49.593 7.54208C49.7496 7.3109 49.8279 7.01634 49.8279 6.65838ZM56.3764 4.5554L55.5859 4.77912C55.5362 4.64737 55.4628 4.51935 55.3659 4.39506C55.2714 4.26829 55.1422 4.16388 54.9781 4.08185C54.8141 3.99982 54.604 3.95881 54.348 3.95881C53.9975 3.95881 53.7054 4.0396 53.4717 4.20117C53.2405 4.36026 53.125 4.56285 53.125 4.80895C53.125 5.0277 53.2045 5.20046 53.3636 5.32724C53.5227 5.45401 53.7713 5.55966 54.1093 5.64418L54.9595 5.85298C55.4715 5.97727 55.8531 6.16744 56.1042 6.42347C56.3552 6.67702 56.4808 7.00391 56.4808 7.40412C56.4808 7.73224 56.3863 8.02557 56.1974 8.28409C56.011 8.54261 55.75 8.74645 55.4144 8.8956C55.0788 9.04474 54.6885 9.11932 54.2436 9.11932C53.6594 9.11932 53.1759 8.99254 52.7931 8.73899C52.4103 8.48544 52.1679 8.11506 52.066 7.62784L52.9012 7.41903C52.9808 7.72727 53.1312 7.95845 53.3524 8.11257C53.5761 8.26669 53.8682 8.34375 54.2286 8.34375C54.6388 8.34375 54.9644 8.25675 55.2056 8.08274C55.4492 7.90625 55.571 7.69496 55.571 7.44886C55.571 7.25 55.5014 7.08345 55.3622 6.94922C55.223 6.8125 55.0092 6.71058 54.7208 6.64347L53.7663 6.41974C53.2418 6.29545 52.8565 6.10281 52.6104 5.8418C52.3668 5.5783 52.245 5.24893 52.245 4.85369C52.245 4.53054 52.3357 4.24467 52.5172 3.99609C52.7011 3.74751 52.951 3.55238 53.2666 3.41069C53.5848 3.269 53.9453 3.19815 54.348 3.19815C54.9147 3.19815 55.3597 3.32244 55.6828 3.57102C56.0085 3.8196 56.2397 4.14773 56.3764 4.5554Z" fill="#495057"/>
                    <path d="M157 5.5L69 5.50001" stroke="url(#paint0_linear_283_6715)" stroke-width="6" stroke-linecap="round"/>
                    <path d="M170.69 9V1.36364H173.36C173.892 1.36364 174.331 1.45561 174.676 1.63956C175.022 1.82102 175.279 2.06587 175.448 2.37411C175.617 2.67986 175.702 3.01918 175.702 3.39205C175.702 3.72017 175.643 3.99112 175.526 4.2049C175.412 4.41868 175.26 4.58771 175.072 4.712C174.885 4.83629 174.683 4.92827 174.464 4.98793V5.0625C174.697 5.07741 174.932 5.15945 175.169 5.30859C175.405 5.45774 175.602 5.67152 175.761 5.94993C175.92 6.22834 176 6.56889 176 6.97159C176 7.3544 175.913 7.69869 175.739 8.00444C175.565 8.31019 175.29 8.55256 174.915 8.73153C174.54 8.91051 174.051 9 173.45 9H170.69ZM171.615 8.17969H173.45C174.054 8.17969 174.482 8.06286 174.736 7.82919C174.992 7.59304 175.12 7.30717 175.12 6.97159C175.12 6.71307 175.054 6.47443 174.922 6.25568C174.791 6.03445 174.603 5.85795 174.359 5.72621C174.116 5.59197 173.827 5.52486 173.494 5.52486H171.615V8.17969ZM171.615 4.71946H173.33C173.609 4.71946 173.86 4.66477 174.083 4.5554C174.31 4.44602 174.489 4.2919 174.62 4.09304C174.755 3.89418 174.822 3.66051 174.822 3.39205C174.822 3.05646 174.705 2.77184 174.471 2.53817C174.238 2.30202 173.867 2.18395 173.36 2.18395H171.615V4.71946ZM179.801 9.11932C179.25 9.11932 178.774 8.99751 178.373 8.75391C177.976 8.50781 177.669 8.16477 177.452 7.72479C177.239 7.28232 177.132 6.76776 177.132 6.18111C177.132 5.59446 177.239 5.07741 177.452 4.62997C177.669 4.18004 177.969 3.82955 178.355 3.57848C178.742 3.32493 179.195 3.19815 179.712 3.19815C180.01 3.19815 180.305 3.24787 180.596 3.3473C180.886 3.44673 181.151 3.60831 181.39 3.83203C181.628 4.05327 181.819 4.34659 181.96 4.712C182.102 5.07741 182.173 5.52734 182.173 6.06179V6.43466H177.758V5.67401H181.278C181.278 5.35085 181.213 5.0625 181.084 4.80895C180.957 4.5554 180.776 4.35529 180.54 4.20863C180.306 4.06197 180.03 3.98864 179.712 3.98864C179.361 3.98864 179.058 4.07564 178.802 4.24964C178.549 4.42116 178.353 4.64489 178.217 4.92081C178.08 5.19673 178.012 5.49254 178.012 5.80824V6.31534C178.012 6.74787 178.086 7.11452 178.235 7.41531C178.387 7.7136 178.597 7.94105 178.866 8.09766C179.134 8.25178 179.446 8.32884 179.801 8.32884C180.033 8.32884 180.241 8.29652 180.428 8.23189C180.617 8.16477 180.78 8.06534 180.916 7.93359C181.053 7.79936 181.159 7.63281 181.233 7.43395L182.083 7.67259C181.994 7.96094 181.843 8.21449 181.632 8.43324C181.421 8.6495 181.16 8.81854 180.849 8.94034C180.538 9.05966 180.189 9.11932 179.801 9.11932ZM184.391 5.55469V9H183.511V3.27273H184.362V4.16761H184.436C184.57 3.87678 184.774 3.64311 185.048 3.46662C185.321 3.28764 185.674 3.19815 186.107 3.19815C186.494 3.19815 186.834 3.2777 187.125 3.43679C187.415 3.59339 187.642 3.83203 187.803 4.1527C187.965 4.47088 188.046 4.87358 188.046 5.3608V9H187.166V5.42045C187.166 4.97053 187.049 4.62003 186.815 4.36896C186.581 4.11541 186.261 3.98864 185.853 3.98864C185.572 3.98864 185.321 4.04954 185.1 4.17134C184.881 4.29315 184.708 4.47088 184.582 4.70455C184.455 4.93821 184.391 5.22159 184.391 5.55469ZM192.055 9.11932C191.503 9.11932 191.027 8.99751 190.627 8.75391C190.229 8.50781 189.922 8.16477 189.706 7.72479C189.492 7.28232 189.385 6.76776 189.385 6.18111C189.385 5.59446 189.492 5.07741 189.706 4.62997C189.922 4.18004 190.223 3.82955 190.608 3.57848C190.996 3.32493 191.448 3.19815 191.965 3.19815C192.264 3.19815 192.558 3.24787 192.849 3.3473C193.14 3.44673 193.405 3.60831 193.643 3.83203C193.882 4.05327 194.072 4.34659 194.214 4.712C194.355 5.07741 194.426 5.52734 194.426 6.06179V6.43466H190.011V5.67401H193.531C193.531 5.35085 193.467 5.0625 193.337 4.80895C193.211 4.5554 193.029 4.35529 192.793 4.20863C192.559 4.06197 192.284 3.98864 191.965 3.98864C191.615 3.98864 191.312 4.07564 191.056 4.24964C190.802 4.42116 190.607 4.64489 190.47 4.92081C190.333 5.19673 190.265 5.49254 190.265 5.80824V6.31534C190.265 6.74787 190.34 7.11452 190.489 7.41531C190.64 7.7136 190.85 7.94105 191.119 8.09766C191.387 8.25178 191.699 8.32884 192.055 8.32884C192.286 8.32884 192.495 8.29652 192.681 8.23189C192.87 8.16477 193.033 8.06534 193.17 7.93359C193.306 7.79936 193.412 7.63281 193.487 7.43395L194.337 7.67259C194.247 7.96094 194.097 8.21449 193.886 8.43324C193.674 8.6495 193.413 8.81854 193.103 8.94034C192.792 9.05966 192.443 9.11932 192.055 9.11932ZM198.315 3.27273V4.01847H195.228V3.27273H198.315ZM196.153 9V2.48224C196.153 2.15412 196.23 1.88068 196.384 1.66193C196.538 1.44318 196.738 1.27912 196.984 1.16974C197.23 1.06037 197.49 1.00568 197.763 1.00568C197.98 1.00568 198.156 1.02308 198.293 1.05788C198.43 1.09268 198.532 1.125 198.599 1.15483L198.345 1.91548C198.3 1.90057 198.238 1.88192 198.159 1.85955C198.082 1.83718 197.98 1.82599 197.853 1.82599C197.562 1.82599 197.352 1.89932 197.223 2.04599C197.096 2.19265 197.033 2.40767 197.033 2.69105V9H196.153ZM199.549 9V3.27273H200.429V9H199.549ZM199.996 2.31818C199.824 2.31818 199.677 2.25977 199.552 2.14293C199.43 2.0261 199.37 1.88565 199.37 1.72159C199.37 1.55753 199.43 1.41708 199.552 1.30025C199.677 1.18342 199.824 1.125 199.996 1.125C200.168 1.125 200.314 1.18342 200.436 1.30025C200.56 1.41708 200.622 1.55753 200.622 1.72159C200.622 1.88565 200.56 2.0261 200.436 2.14293C200.314 2.25977 200.168 2.31818 199.996 2.31818ZM204.367 9.11932C203.83 9.11932 203.368 8.99254 202.98 8.73899C202.592 8.48544 202.294 8.13619 202.085 7.69123C201.876 7.24627 201.772 6.73793 201.772 6.16619C201.772 5.58452 201.879 5.0712 202.092 4.62624C202.309 4.1788 202.61 3.82955 202.995 3.57848C203.383 3.32493 203.835 3.19815 204.352 3.19815C204.755 3.19815 205.118 3.27273 205.441 3.42188C205.764 3.57102 206.029 3.77983 206.235 4.0483C206.441 4.31676 206.569 4.62997 206.619 4.98793H205.739C205.672 4.72692 205.523 4.49574 205.292 4.29439C205.063 4.09055 204.755 3.98864 204.367 3.98864C204.024 3.98864 203.723 4.07812 203.465 4.2571C203.209 4.43359 203.008 4.68342 202.864 5.00657C202.723 5.32724 202.652 5.70384 202.652 6.13636C202.652 6.57884 202.721 6.96413 202.861 7.29226C203.002 7.62038 203.201 7.87518 203.457 8.05664C203.716 8.2381 204.019 8.32884 204.367 8.32884C204.596 8.32884 204.803 8.28906 204.99 8.20952C205.176 8.12997 205.334 8.01562 205.463 7.86648C205.592 7.71733 205.684 7.53835 205.739 7.32955H206.619C206.569 7.66761 206.446 7.97212 206.25 8.24308C206.056 8.51154 205.799 8.72532 205.478 8.88441C205.16 9.04102 204.79 9.11932 204.367 9.11932ZM207.905 9V3.27273H208.785V9H207.905ZM208.353 2.31818C208.181 2.31818 208.034 2.25977 207.909 2.14293C207.787 2.0261 207.727 1.88565 207.727 1.72159C207.727 1.55753 207.787 1.41708 207.909 1.30025C208.034 1.18342 208.181 1.125 208.353 1.125C208.524 1.125 208.671 1.18342 208.793 1.30025C208.917 1.41708 208.979 1.55753 208.979 1.72159C208.979 1.88565 208.917 2.0261 208.793 2.14293C208.671 2.25977 208.524 2.31818 208.353 2.31818ZM212.083 9.13423C211.72 9.13423 211.39 9.06587 211.094 8.92915C210.799 8.78995 210.564 8.58984 210.39 8.32884C210.216 8.06534 210.129 7.74716 210.129 7.37429C210.129 7.04616 210.193 6.78018 210.323 6.57635C210.452 6.37003 210.625 6.20845 210.841 6.09162C211.057 5.97479 211.296 5.88778 211.557 5.83061C211.82 5.77095 212.085 5.72372 212.351 5.68892C212.699 5.64418 212.981 5.61062 213.197 5.58825C213.416 5.56339 213.575 5.52237 213.675 5.4652C213.777 5.40803 213.828 5.30859 213.828 5.1669V5.13707C213.828 4.76918 213.727 4.48331 213.526 4.27947C213.327 4.07564 213.025 3.97372 212.619 3.97372C212.199 3.97372 211.87 4.0657 211.631 4.24964C211.393 4.43359 211.225 4.62997 211.128 4.83878L210.293 4.54048C210.442 4.19247 210.641 3.92152 210.889 3.72763C211.14 3.53125 211.414 3.39453 211.71 3.31747C212.008 3.23793 212.301 3.19815 212.59 3.19815C212.774 3.19815 212.985 3.22053 213.224 3.26527C213.465 3.30753 213.697 3.39577 213.921 3.53001C214.147 3.66424 214.335 3.86683 214.484 4.13778C214.633 4.40874 214.708 4.77166 214.708 5.22656V9H213.828V8.22443H213.783C213.723 8.34872 213.624 8.48171 213.485 8.6234C213.345 8.76509 213.16 8.88565 212.929 8.98509C212.698 9.08452 212.416 9.13423 212.083 9.13423ZM212.217 8.34375C212.565 8.34375 212.858 8.27539 213.097 8.13867C213.338 8.00195 213.519 7.82546 213.641 7.6092C213.765 7.39293 213.828 7.16548 213.828 6.92685V6.12145C213.79 6.16619 213.708 6.20721 213.581 6.2445C213.457 6.2793 213.313 6.31037 213.149 6.33771C212.987 6.36257 212.83 6.38494 212.675 6.40483C212.524 6.42223 212.401 6.43714 212.306 6.44957C212.078 6.4794 211.864 6.52788 211.665 6.59499C211.469 6.65962 211.309 6.75781 211.188 6.88956C211.068 7.01882 211.009 7.19531 211.009 7.41903C211.009 7.72479 211.122 7.95597 211.348 8.11257C211.577 8.26669 211.866 8.34375 212.217 8.34375ZM217.194 1.36364V9H216.314V1.36364H217.194Z" fill="#495057"/>
                    <defs>
                    <linearGradient id="paint0_linear_283_6715" x1="157" y1="6" x2="69" y2="6.00001" gradientUnits="userSpaceOnUse">
                    <stop stop-color="#3F4CBD"/>
                    <stop offset="0.5" stop-color="#F5F3F0"/>
                    <stop offset="1" stop-color="#B1242B"/>
                    </linearGradient>
                    </defs>
                  </svg>
                </div>
                  
                <!-- debug - selected cells: {{ selectedCells | json }} -->
                <div class="h-full overflow-x-scroll">
                  <app-heatmap
                    #heatmap
                    [data]="result"
                    [mutedCells]="mutedCells"
                    [(selectedCells)]="selectedCells"
                  ></app-heatmap>
                </div>
              </div>
              <div class="flex flex-col gap-4 w-1/2">
                <p class="font-semibold underline decoration-dotted">Structure</p>
                <!-- <app-molecule3d></app-molecule3d> -->
              </div>
            </div>
        </div>

        <!-- Table -->
        <hr> <!-- hr for border styling -->
        <p-table 
          #resultTable
          [columns]="columns" 
          
          [scrollable]="true" 
          scrollHeight="400px" 
          styleClass="w-full" 
          tableStyleClass="w-full border-b-0"

          [value]="tableValues" 
        >
          <ng-template pTemplate="header">
            <tr>
              <th class="align-middle relative group w-1/3" pSortableColumn="position">
                <span>Position</span>
                <p-sortIcon
                  class="absolute top-0 right-0 p-2 text-[#6C757D] [.p-highlight_&]:!visible invisible group-hover:visible"
                  field="position" />
              </th>
              <th class="align-middle relative group w-1/3" pSortableColumn="mutationLabel">
                <span>Detailed Mutation</span>
                <p-sortIcon
                  class="absolute top-0 right-0 p-2 text-[#6C757D] [.p-highlight_&]:!visible invisible group-hover:visible"
                  field="mutationLabel" />
              </th>
              <th class="align-middle relative group w-1/3" pSortableColumn="score">
                <span>Predicted Effect (Score)</span>
                <p-sortIcon
                  class="absolute top-0 right-0 p-2 text-[#6C757D] [.p-highlight_&]:!visible invisible group-hover:visible"
                  field="score" />
              </th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-row let-expanded="expanded">
            <tr [attr.data-position]="row.position">
              <td class="align-middle border-b border-solid border-[#dee2e6] !p-2">
                {{ row.position }}
              </td>
              <td class="align-middle border-b border-solid border-[#dee2e6] !p-2">
                {{ row.mutationLabel }}
              </td>
              <td class="align-middle border-b border-solid border-[#dee2e6] !p-2">
                <app-score-chip [score]="row.score"></app-score-chip>
              </td>
            </tr>
          </ng-template>
        </p-table>

      </ng-template>
    </p-panel>
  </div>
</div>
}