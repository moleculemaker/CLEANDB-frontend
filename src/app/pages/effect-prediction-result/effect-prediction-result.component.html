<app-job-tab [tab]="currentPage" (onTabChange)="currentPage = $event"></app-job-tab>

@if (currentPage === 'input') {
<app-effect-prediction [formValue]="jobInfo" [showJobTab]="false"></app-effect-prediction>

} @else {
<!-- Model Results -->
<div class="flex flex-col h-full gap-8">
  <div class="flex items-center justify-between">
    @let status = statusResponse$ | async;
    @if (status) {
      <div>
        <h5 class="flex items-center gap-2 mb-2 font-bold opacity-100 leading-xl">
          Job ID: {{ status.job_id || "loading" }}
          <button type="button" title="copy job id" class="border-none cursor-pointer">
            <i class="pi pi-copy" (click)="copyAndPasteURL()"></i>
          </button>
        </h5>
        <h6 class="text-text-secondary leading-lg">
          Submission Time:
          {{ (status.time_created || 0) * 1000 | date : "short" }}
        </h6>
      </div>
    }
    <div class="flex items-center gap-2">

      <!-- TODO: add button here -->

    </div>
  </div>

  @if (!showResults) {
    <app-loading 
      [statusQuery$]="statusResponse$" 
      (progressChange)="onProgressChange($event)"
      [estimatedTime]="1 * 60"
    >
    </app-loading>
    }

    <div class="flex flex-col gap-8" [class.hidden]="!showResults">
      <p-panel>
        <ng-template pTemplate="header">
          <h6 class="grow">Results</h6>
        </ng-template>
        <ng-template pTemplate="content">
          <div class="flex flex-col gap-6 p-6">
            <!-- Enzyme Sequence -->
            <div class="flex flex-col gap-4">
              <p class="font-semibold underline decoration-dotted">Enzyme Sequence</p>
              <app-sequence-position-selector></app-sequence-position-selector>
            </div>

            <!-- Mutation Effect and Structure -->
            <div class="flex gap-4">
              <div class="flex flex-col gap-4">
                <p class="font-semibold underline decoration-dotted">Mutation Effect Heatmap</p>
                <!-- <app-heatmap></app-heatmap> -->
              </div>
              <div class="flex flex-col gap-4">
                <p class="font-semibold underline decoration-dotted">Structure</p>
                <app-molecule3d></app-molecule3d>
              </div>
            </div>

            <!-- Table -->
             
          </div>
        </ng-template>
      </p-panel>
    </div>
</div>
}